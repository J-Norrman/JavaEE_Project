<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Home</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}" />
</head>
<body>
<header>
    <div class="header-container">
        <h1>Welcome to Weather App</h1>
    <div class="redi-buttons">
        <button onclick="window.location.href='/login'">Login</button>
        <button onclick="window.location.href='/register'">Register</button>
    </div>
    </div>
</header>
<main>
    <div th:if="${authentication != null}">
        <h2>Welcome, <span th:text="${authentication.name}"></span></h2>
    </div>
    <!-- Buttons to toggle between Current Weather and Forecast -->
    <div class="buttons">
        <button onclick="showSearchBar('current')">Current Weather</button>
        <button onclick="showSearchBar('forecast')">Forecast</button>
    </div>

    <!-- Search bar for Current Weather -->
    <div id="currentWeatherSearch" class="search-bar"
         th:classappend="${weatherData != null or (weatherData == null and forecastData == null)} ? ' active' : ''">
        <form th:action="@{/weather/search}" method="get">
            <input type="text" name="city" placeholder="Enter city" required />
            <button type="submit">Search</button>
        </form>
        <!-- Display Current Weather information -->
        <div class="results" th:if="${weatherData != null}">
            <div class="results-card">
            <h3>Current weather in <span th:text="${weatherData.city_name}"></span></h3>
            <p>Temperature: <span th:text="${weatherData.temp}"></span>째C</p>
            <p>Wind Direction: <span th:text="${weatherData.wind_cdir_full}"></span></p>
            <p>Wind Speed: <span th:text="${weatherData.wind_spd}"></span> km/h</p>
            <p>Sunrise: <span th:text="${weatherData.sunrise}"></span></p>
            <p>Sunset: <span th:text="${weatherData.sunset}"></span></p>
            <p>Precipitation: <span th:text="${weatherData.precip}"></span> mm</p>
            </div>
        </div>
        <div class="results" th:if="${weatherData == null}">
            <p>Check the current weather of a city.</p>
        </div>
    </div>

    <!-- Search bar for Forecast -->
    <div id="forecastSearch" class="search-bar"
         th:classappend="${forecastData != null} ? ' active' : ''">
        <form th:action="@{/forecast/search}" method="get">
            <input type="text" name="city" placeholder="Enter city" required />
            <button type="submit">Search</button>
        </form>
        <!-- Display Forecast information -->
        <div class="results" th:if="${forecastData != null}">
            <h3>Weather Forecast in <span th:text="${forecastData.city_name}"></span></h3>
            <div class="forecast-grid">
                <div th:each="forecast : ${forecastData.forecasts}" class="results-card">
                    <h4>
                        <span th:text="${forecast.valid_date}"></span>
                        (<span th:text="${forecast.day_of_week}"></span>)
                    </h4>
                    <p>Temperature: <span th:text="${forecast.temp}"></span>째C</p>
                    <p>Max Temp: <span th:text="${forecast.max_temp}"></span>째C</p>
                    <p>Min Temp: <span th:text="${forecast.min_temp}"></span>째C</p>
                    <p>Wind Speed: <span th:text="${forecast.wind_spd}"></span> km/h</p>
                    <p>Wind Direction: <span th:text="${forecast.wind_cdir_full}"></span></p>
                </div>
            </div>
        </div>
        <div class="results" th:if="${forecastData == null}">
            <p>Check the weather forecast for a city.</p>
        </div>
    </div>
</main>
<script th:src="@{/js/scripts.js}"></script>
</body>
</html>
